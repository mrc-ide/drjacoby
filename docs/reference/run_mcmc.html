<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run drjacoby MCMC — run_mcmc • drjacoby</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run drjacoby MCMC — run_mcmc" />
<meta property="og:description" content="Run MCMC either with or without parallel tempering turned on.
  Minimum inputs include a data object, a data.frame of parameters, a
  log-likelihood function and a log-prior function. Produces an object of
  class drjacoby_output, which contains all MCMC output along with
  some diagnostics and a record of inputs." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">drjacoby</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/example.html">Basic Example</a>
    </li>
    <li>
      <a href="../articles/metropolis_coupling.html">Parallel Tempering</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Running Parallel Chains</a>
    </li>
    <li>
      <a href="../articles/blocks.html">Using Likelihood Blocks</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Checks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/checks_return_prior.html">Return prior</a>
    </li>
    <li>
      <a href="../articles/checks_normal_model.html">Normal model</a>
    </li>
    <li>
      <a href="../articles/checks_double_well.html">Double well</a>
    </li>
    <li>
      <a href="../articles/checks_multilevel_blocks.html">Multilevel blocks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mrc-ide/drjacoby">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run drjacoby MCMC</h1>
    <small class="dont-index">Source: <a href='https://github.com/mrc-ide/drjacoby/blob/master/R/main.R'><code>R/main.R</code></a></small>
    <div class="hidden name"><code>run_mcmc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Run MCMC either with or without parallel tempering turned on.
  Minimum inputs include a data object, a data.frame of parameters, a
  log-likelihood function and a log-prior function. Produces an object of
  class <code>drjacoby_output</code>, which contains all MCMC output along with
  some diagnostics and a record of inputs.</p>
    </div>

    <pre class="usage"><span class='fu'>run_mcmc</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>df_params</span>,
  misc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>loglike</span>,
  <span class='va'>logprior</span>,
  burnin <span class='op'>=</span> <span class='fl'>1000</span>,
  samples <span class='op'>=</span> <span class='fl'>10000</span>,
  rungs <span class='op'>=</span> <span class='fl'>1</span>,
  chains <span class='op'>=</span> <span class='fl'>5</span>,
  beta_manual <span class='op'>=</span> <span class='cn'>NULL</span>,
  alpha <span class='op'>=</span> <span class='fl'>1</span>,
  cluster <span class='op'>=</span> <span class='cn'>NULL</span>,
  coupling_on <span class='op'>=</span> <span class='cn'>TRUE</span>,
  pb_markdown <span class='op'>=</span> <span class='cn'>FALSE</span>,
  save_data <span class='op'>=</span> <span class='cn'>TRUE</span>,
  save_hot_draws <span class='op'>=</span> <span class='cn'>FALSE</span>,
  silent <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a named list of numeric data values. When using C++ likelihood
and/or prior these values are treated internally as doubles, so while
integer and Boolean values can be used, keep in mind that these will be
recast as doubles in the likelihood (i.e. <code>TRUE = 1.0</code>).</p></td>
    </tr>
    <tr>
      <th>df_params</th>
      <td><p>a data.frame of parameters (see <code><a href='define_params.html'>?define_params</a></code>).</p></td>
    </tr>
    <tr>
      <th>misc</th>
      <td><p>optional list object passed to likelihood and prior. This can be
useful for passing values that are not strictly data, for example passing a
lookup table to the prior function.</p></td>
    </tr>
    <tr>
      <th>loglike, logprior</th>
      <td><p>the log-likelihood and log-prior functions used in
the MCMC. Can either be passed in as R functions (not in quotes), or as
character strings naming compiled C++ functions (in quotes).</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>the number of burn-in iterations. Automatic tuning of proposal
standard deviations is only active during the burn-in period.</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>the number of sampling iterations.</p></td>
    </tr>
    <tr>
      <th>rungs</th>
      <td><p>the number of temperature rungs used in the parallel tempering
method. By default, \(\beta\) values are equally spaced between 0 and 1,
i.e. \(\beta[i]=\)<code>(i-1)/(rungs-1)</code> for <code>i</code> in <code>1:rungs</code>.
The likelihood for the i<sup>th</sup> heated chain is raised to the
power \(\beta[i]^\alpha\), meaning we can use the \(\alpha\) parameter
to concentrate rungs towards the start or the end of the interval (see the
<code>alpha</code> argument).</p></td>
    </tr>
    <tr>
      <th>chains</th>
      <td><p>the number of independent replicates of the MCMC to run. If a
<code>cluster</code> object is defined then these chains are run in parallel,
otherwise they are run in serial.</p></td>
    </tr>
    <tr>
      <th>beta_manual</th>
      <td><p>vector of manually defined \(\beta\) values used in the
parallel tempering approach. If defined, this overrides the spacing defined
by <code>rungs</code>. Note that even manually defined \(\beta\) values are
raised to the power \(\alpha\) internally, hence you should set
<code>alpha = 1</code> if you want to fix \(\beta\) values exactly.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>the likelihood for the i<sup>th</sup> heated chain is
raised to the power \(\beta[i]^\alpha\), meaning we can use the
\(\alpha\) parameter to concentrate rungs towards the start or the end of
the temperature scale.</p></td>
    </tr>
    <tr>
      <th>cluster</th>
      <td><p>option to pass in a cluster environment, allowing chains to be
run in parallel (see package "parallel").</p></td>
    </tr>
    <tr>
      <th>coupling_on</th>
      <td><p>whether to implement Metropolis-coupling over temperature
rungs. The option of deactivating coupling has been retained for general
interest and debugging purposes only. If this parameter is <code>FALSE</code>
then parallel tempering will have no impact on MCMC mixing.</p></td>
    </tr>
    <tr>
      <th>pb_markdown</th>
      <td><p>whether to run progress bars in markdown mode, meaning
they are only updated when they reach 100% to avoid large amounts of output
being printed to markdown files.</p></td>
    </tr>
    <tr>
      <th>save_data</th>
      <td><p>if <code>TRUE</code> (the default) the raw input data is stored
for reference in the project output. This allows complete reproducibility
from a project, but may be undesirable when datasets are very large.</p></td>
    </tr>
    <tr>
      <th>save_hot_draws</th>
      <td><p>if <code>TRUE</code> the parameter draws relating to the hot
chains are also stored inside the <code>pt</code> element of the project output.
If <code>FALSE</code> (the default) only log-likelihoods and log-priors are
stored from heated chains.</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>whether to suppress all console output.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Note that both <code>data</code> and <code>misc</code> are passed into
  log-likelihood/log-prior functions *by reference*. This means if you modify
  these objects inside the functions then any changes will persist.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bob Verity, Pete Winskill.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


