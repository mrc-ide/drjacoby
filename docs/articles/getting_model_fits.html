<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Model Fits • drjacoby</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Model Fits">
<meta property="og:description" content="drjacoby">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">drjacoby</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/example.html">Basic Example</a>
    </li>
    <li>
      <a href="../articles/metropolis_coupling.html">Parallel Tempering</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Running Parallel Chains</a>
    </li>
    <li>
      <a href="../articles/getting_model_fits.html">Getting Model Fits</a>
    </li>
    <li>
      <a href="../articles/blocks.html">Using Likelihood Blocks</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Checks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/checks_return_prior.html">Return prior</a>
    </li>
    <li>
      <a href="../articles/checks_normal_model.html">Normal model</a>
    </li>
    <li>
      <a href="../articles/checks_double_well.html">Double well</a>
    </li>
    <li>
      <a href="../articles/checks_multilevel_blocks.html">Multilevel blocks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/drjacoby" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Model Fits</h1>
                        <h4 data-toc-skip class="author">Bob Verity and
Pete Winskill</h4>
            
            <h4 data-toc-skip class="date">2024-06-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/drjacoby/blob/HEAD/vignettes/getting_model_fits.Rmd" class="external-link"><code>vignettes/getting_model_fits.Rmd</code></a></small>
      <div class="hidden name"><code>getting_model_fits.Rmd</code></div>

    </div>

    
    
<pre><code><span><span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span></span>
<span><span class="co">#&gt;   method from   </span></span>
<span><span class="co">#&gt;   +.gg   ggplot2</span></span></code></pre>
<p>Sometimes our likelihood function involves calculating a series of
intermediate values. A good example is when we have a model that
describes our fit to the data, which may be combined with an error term
to capture random noise around this prediction. Once the MCMC has
finished, we may want to extract this model fit so that we can see how
good it really is. Having already written down the code for calculating
the model fit once within the likelihood, we don’t want to have to write
it down again when visualising results as this duplication of work is
not only a waste of time but also can introduce errors.</p>
<p>This vignette demonstrates how intermediate values can be obtained
from MCMC output using a single likelihood function.</p>
<div class="section level2">
<h2 id="a-simple-model-of-population-growth">A simple model of population growth<a class="anchor" aria-label="anchor" href="#a-simple-model-of-population-growth"></a>
</h2>
<p>For this example we will use some data on population growth and we
will attempt to fit a simple curve through these points. The data can be
loaded directly from within the <em>drjacoby</em> package, and takes the
form of a simple data.frame of sampling times and population sizes:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"population_data"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">population_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   pop time</span></span>
<span><span class="co">#&gt; 1  14   33</span></span>
<span><span class="co">#&gt; 2  26   37</span></span>
<span><span class="co">#&gt; 3  36   41</span></span>
<span><span class="co">#&gt; 4  30   43</span></span>
<span><span class="co">#&gt; 5  37   44</span></span>
<span><span class="co">#&gt; 6  57   48</span></span>
<span></span>
<span><span class="co"># plot points</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">population_data</span><span class="op">$</span><span class="va">time</span>, <span class="va">population_data</span><span class="op">$</span><span class="va">pop</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">120</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time (days)"</span>, ylab <span class="op">=</span> <span class="st">"Population size"</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_model_fits_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>For our model we will assume a discrete-time logistic growth model,
in which the population starts at size <span class="math inline">\(N_0\)</span> and grows at a rate <span class="math inline">\(r\)</span> each timestep, but also experiences
density-dependent death causing it to plateau out at a maximum
population size <span class="math inline">\(N_{max}\)</span>. If we use
<span class="math inline">\(N_t\)</span> to denote the population size
at time <span class="math inline">\(t\)</span> then we can write this
model as follows:</p>
<p><span class="math display">\[
\begin{align}
  N_{t+1} = rN_t(1 - N_t / K), \hspace{10mm} \mbox{where } K =
N_{\mbox{max}}\left(\frac{r}{r-1}\right).
\end{align}
\]</span></p>
<p>There are three parameters in this model, and so our parameters
dataframe should contain the three variables with suitable ranges as
follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define parameters dataframe</span></span>
<span><span class="va">df_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_params.html">define_params</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"N_0"</span>, min <span class="op">=</span> <span class="fl">1</span>, max <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                           name <span class="op">=</span> <span class="st">"r"</span>, min <span class="op">=</span> <span class="fl">1</span>, max <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                           name <span class="op">=</span> <span class="st">"N_max"</span>, min <span class="op">=</span> <span class="fl">50</span>, max <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p>Within our likelihood function we need to calculate our expected
population growth curve. This curve is perfectly smooth, but the real
data is noisy so we will use a Poisson distribution to link the data to
the model.</p>
<p>Crucially, when defining the likelihood function we will create an
option to return the model prediction, rather than the log-likelihood.
We use the <code>misc</code> input to the function to control whether
this option is active or not. If we set
<code>misc$output_type = 1</code> then we will obtain the
log-likelihood, but if we set <code>misc$output_type = 2</code> then we
will obtain the complete curve of model-predicted values:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define log-likelihood function</span></span>
<span><span class="va">loglike</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">data</span>, <span class="va">misc</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># extract parameter values</span></span>
<span>  <span class="va">N_0</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">[</span><span class="st">"N_0"</span><span class="op">]</span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">[</span><span class="st">"r"</span><span class="op">]</span></span>
<span>  <span class="va">N_max</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">[</span><span class="st">"N_max"</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># calculate expected population growth</span></span>
<span>  <span class="va">K</span> <span class="op">&lt;-</span> <span class="va">N_max</span> <span class="op">*</span> <span class="va">r</span> <span class="op">/</span> <span class="op">(</span><span class="va">r</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">N_0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">K</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># option to return model prediction rather than log-likelihood</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">misc</span><span class="op">$</span><span class="va">output_type</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># calculate log-likelihood</span></span>
<span>  <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">pop</span>, lambda <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">time</span><span class="op">]</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># return</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">ret</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># define R logprior function</span></span>
<span><span class="va">logprior</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">misc</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a></span><span class="op">(</span><span class="va">params</span><span class="op">[</span><span class="st">"N_0"</span><span class="op">]</span>, <span class="fl">1</span>, <span class="fl">100</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a></span><span class="op">(</span><span class="va">params</span><span class="op">[</span><span class="st">"r"</span><span class="op">]</span>, <span class="fl">1</span>, <span class="fl">2</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a></span><span class="op">(</span><span class="va">params</span><span class="op">[</span><span class="st">"N_max"</span><span class="op">]</span>, <span class="fl">50</span>, <span class="fl">200</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>When running the MCMC we want to make sure
<code>misc$output_type = 1</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run MCMC</span></span>
<span><span class="va">mcmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mcmc.html">run_mcmc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">population_data</span>,</span>
<span>                 df_params <span class="op">=</span> <span class="va">df_params</span>,</span>
<span>                 misc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>output_type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                 loglike <span class="op">=</span> <span class="va">loglike</span>,</span>
<span>                 logprior <span class="op">=</span> <span class="va">logprior</span>,</span>
<span>                 burnin <span class="op">=</span> <span class="fl">1e3</span>,</span>
<span>                 samples <span class="op">=</span> <span class="fl">1e4</span>,</span>
<span>                 chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                 pb_markdown <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; MCMC chain 1</span></span>
<span><span class="co">#&gt; burn-in</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; acceptance rate: 42.5%</span></span>
<span><span class="co">#&gt; sampling phase</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; acceptance rate: 43.9%</span></span>
<span><span class="co">#&gt; chain completed in 1.800967 seconds</span></span>
<span><span class="co">#&gt; MCMC chain 2</span></span>
<span><span class="co">#&gt; burn-in</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; acceptance rate: 43.1%</span></span>
<span><span class="co">#&gt; sampling phase</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; acceptance rate: 44%</span></span>
<span><span class="co">#&gt; chain completed in 1.669812 seconds</span></span>
<span><span class="co">#&gt; MCMC chain 3</span></span>
<span><span class="co">#&gt; burn-in</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; acceptance rate: 42.9%</span></span>
<span><span class="co">#&gt; sampling phase</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; acceptance rate: 44%</span></span>
<span><span class="co">#&gt; chain completed in 1.647409 seconds</span></span>
<span><span class="co">#&gt; total MCMC run-time: 5.12 seconds</span></span></code></pre></div>
<p>Once we have MCMC output we should perform our usual checks to make
sure that everything has converged nicely (we will skip this step here
in the interest of time). Assuming everything is OK, we can move on to
exploring model fits. We will do this by running the same likelihood
function but with <code>misc$output_type = 2</code>, using the posterior
parameter draws as inputs. We may not want to use every posterior
parameter draw, in which case we can use the
<code><a href="../reference/sample_chains.html">sample_chains()</a></code> function to sub-sample the output down as
needed:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sample from posterior</span></span>
<span><span class="va">param_draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_chains.html">sample_chains</a></span><span class="op">(</span><span class="va">mcmc</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get matrix of model predictions</span></span>
<span><span class="va">model_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">param_draws</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">loglike</span><span class="op">(</span>params <span class="op">=</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">population_data</span>, misc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>output_type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Plotting these against the data we can see that - reassuringly - the
posterior model fits make a smooth curve through the data points:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">model_matrix</span>, type <span class="op">=</span> <span class="st">'l'</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"#99000010"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">120</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"Time (days)"</span>, ylab <span class="op">=</span> <span class="st">"Population size"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">population_data</span><span class="op">$</span><span class="va">time</span>, <span class="va">population_data</span><span class="op">$</span><span class="va">pop</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_model_fits_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Notice that we only had to define the model fitting computation once
in this pipeline, as the same likelihood function was used for both
inference and obtaining the fit. There are more complicated versions of
this approach that may be useful in some settings, for example using
<code>switch</code> functions or multiple <code>if</code> statements to
allow for several different types of output from the likelihood
function, or even varying aspects of the core model such as the error
distribution using flags contained in <code>misc</code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bob Verity, Pete Winskill.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
